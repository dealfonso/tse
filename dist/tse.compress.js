/* Copyright 2025 Carlos A. (https://github.com/dealfonso); License: https://opensource.org/license/mit/ */
{if(window,"undefined"==typeof window)throw new Error("This script must be executed in a browser environment.");let o={},i={attributePrefix:"data-bind-",templateDelimiter:/\${([^}]*)}/g,evalContext:window,observeMutations:!0,debounceTime:50},a=null;function r(t,e){try{var n={...e||{},...o};return new Function("context",`with(context) { return ${t}; }`)(n)}catch(e){return console.error(`Error evaluating expression "${t}":`,e),`[Error: ${e.message}]`}}function u(e){var t,n=e.nodeValue;i.templateDelimiter.test(n)&&(i.templateDelimiter.lastIndex=0,(t=n.replace(i.templateDelimiter,(e,t)=>{t=r(t);return void 0!==t?t:e}))!==n)&&(e.nodeValue=t)}function d(n){Array.from(n.attributes).forEach(e=>{var t;e.name.startsWith(i.attributePrefix)&&(t=e.name.substring(i.attributePrefix.length),e=r(e.value),n[t]=e)})}function c(e=document.body){for(var t,n=document.createTreeWalker(e,NodeFilter.SHOW_TEXT|NodeFilter.SHOW_ELEMENT,null,!1);t=n.nextNode();)t.nodeType===Node.TEXT_NODE?u(t):t.nodeType===Node.ELEMENT_NODE&&d(t)}window.DOMTemplateStringEvaluator={init:function(e={}){let t={...i},n=(i={...i,...e},e.evalContext&&Object.assign(o,e.evalContext),"loading"!==document.readyState),r=()=>{if(i.observeMutations){if((!a||t.debounceTime!==i.debounceTime||!t.observeMutations)&&window.MutationObserver){a&&(a.disconnect(),a=null);let t,e=new MutationObserver(e=>{clearTimeout(t),t=setTimeout(()=>{e.forEach(e=>{e.addedNodes.forEach(e=>{e.nodeType===Node.TEXT_NODE?u(e):e.nodeType===Node.ELEMENT_NODE&&(d(e),c(e))}),"attributes"===e.type&&d(e.target),"characterData"===e.type&&u(e.target)})},i.debounceTime)});e.observe(document.body,{childList:!0,attributes:!0,characterData:!0,subtree:!0}),a=e}}else a&&(a.disconnect(),a=null)};return n?(c(),r()):document.addEventListener("DOMContentLoaded",()=>{c(),r()}),this},scan:function(e=document.body){return c(e),this},addToContext:function(e){return Object.assign(o,e),this},evaluate:function(e){return r(e,i.evalContext)},getConfig:function(){return{...i}},getVersion:function(){return"1.0.0"}},document.addEventListener("DOMContentLoaded",function(){DOMTemplateStringEvaluator.init()})}